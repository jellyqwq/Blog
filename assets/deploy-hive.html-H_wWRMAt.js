import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as o,o as c,c as i,f as l,b as a,d as n,e,a as t}from"./app-XoEOURcT.js";const d={},r=t(`<h2 id="前置" tabindex="-1"><a class="header-anchor" href="#前置" aria-hidden="true">#</a> 前置</h2><p>Hive 的使用需要依赖MySQL, 这里使用了mariadb来作为MySQL, 它是兼容MySQL的.</p><h3 id="镜像拉取" tabindex="-1"><a class="header-anchor" href="#镜像拉取" aria-hidden="true">#</a> 镜像拉取</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull mariadb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="运行实例" tabindex="-1"><a class="header-anchor" href="#运行实例" aria-hidden="true">#</a> 运行实例</h3><table><thead><tr><th>参数</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>–i</td><td></td><td>创建交互式会话</td></tr><tr><td>-t</td><td></td><td>创建伪终端</td></tr><tr><td>-d</td><td></td><td>后台启动</td></tr><tr><td>--privileged=true</td><td></td><td>使用特权模式启动, 以允许容器对宿主机的写入</td></tr><tr><td>--name</td><td>mariadb</td><td>容器名字</td></tr><tr><td>--network</td><td>misaka</td><td>将数据库接入misaka网络</td></tr><tr><td>--ip</td><td>192.168.60.100</td><td>容器IP</td></tr><tr><td>-p</td><td>3306:3306</td><td>端口映射</td></tr><tr><td>-v</td><td>/d/Desktop/BD/resolv.conf:/etc/resolv.conf</td><td>挂载目录使dns持久化</td></tr><tr><td>-e</td><td>MARIADB_ROOT_PASSWORD=123456</td><td>设置数据库root用户密码</td></tr><tr><td>-e</td><td>MARIADB_DATABASE=hive</td><td>创建名为hive的数据库</td></tr><tr><td>-e</td><td>MARIADB_USER=hive</td><td>创建数据库用户hive</td></tr><tr><td>-e</td><td>MARIADB_PASSWORD=123456</td><td>指定123456为上述用户的密码</td></tr></tbody></table>`,6),u={href:"https://docs.docker.com/engine/reference/commandline/create/#options",target:"_blank",rel:"noopener noreferrer"},k=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-i</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token parameter variable">--name</span> mariadb <span class="token parameter variable">--network</span> misaka <span class="token parameter variable">--ip</span> <span class="token number">192.168</span>.60.100 <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-v</span> /d/Desktop/BD/resolv.conf:/etc/resolv.conf <span class="token parameter variable">-e</span> <span class="token string">&quot;MARIADB_ROOT_PASSWORD=123456&quot;</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;MARIADB_DATABASE=hive&quot;</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;MARIADB_USER=hive&quot;</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;MARIADB_PASSWORD=123456&quot;</span> mariadb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>用 <code>-v /d/Desktop/BD/mariadb/data:/var/lib/mysql</code> 来本地挂载数据卷会导致 <code>schemea</code> 出问题, 不建议使用这么用, 默认会使用 <code>docker</code> 的 <code>volumes</code> 来挂载 <code>/var/lib/mysql</code></p><h3 id="给hive用户数据库权限" tabindex="-1"><a class="header-anchor" href="#给hive用户数据库权限" aria-hidden="true">#</a> 给hive用户数据库权限</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">Grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> hive<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">&#39;hive&#39;</span><span class="token variable">@&#39;192.168.60.100&#39;</span> identified <span class="token keyword">by</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/84cbd72b-1257-4867-85c8-a5be1bc4d26b.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="hive-安装" tabindex="-1"><a class="header-anchor" href="#hive-安装" aria-hidden="true">#</a> Hive 安装</h2>`,6),h={href:"https://hive.apache.org/general/downloads/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://dlcdn.apache.org/hive/hive-3.1.3/",target:"_blank",rel:"noopener noreferrer"},g=t(`<h3 id="下载hive" tabindex="-1"><a class="header-anchor" href="#下载hive" aria-hidden="true">#</a> 下载hive</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">wget</span> https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="解压hive" tabindex="-1"><a class="header-anchor" href="#解压hive" aria-hidden="true">#</a> 解压hive</h3><blockquote><p>-C path 解压到指定目录</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">tar</span> <span class="token parameter variable">-zxf</span> apache-hive-3.1.3-bin.tar.gz <span class="token parameter variable">-C</span> /usr/local/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="重命名hive目录" tabindex="-1"><a class="header-anchor" href="#重命名hive目录" aria-hidden="true">#</a> 重命名hive目录</h3><p>解压出来的hive一般是这样的: <code>apache-hive-3.1.3-bin</code>, 为了方便配置可以重命名下</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mv</span> /usr/local/apache-hive-3.1.3-bin /usr/local/hive-3.1.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="设置hive属组" tabindex="-1"><a class="header-anchor" href="#设置hive属组" aria-hidden="true">#</a> 设置Hive属组</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">chown</span> <span class="token parameter variable">-R</span> root /usr/local/hive-3.1.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="添加hive环境变量" tabindex="-1"><a class="header-anchor" href="#添加hive环境变量" aria-hidden="true">#</a> 添加hive环境变量</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&#39;export HIVE_HOME=/usr/local/hive-3.1.3&#39;</span> <span class="token operator">&gt;&gt;</span> /etc/profile.d/hadoop.sh
<span class="token builtin class-name">echo</span> <span class="token string">&#39;export PATH=$PATH:$HIVE_HOME/bin&#39;</span> <span class="token operator">&gt;&gt;</span> /etc/profile.d/hadoop.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="刷新环境变量" tabindex="-1"><a class="header-anchor" href="#刷新环境变量" aria-hidden="true">#</a> 刷新环境变量</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">source</span> /etc/profile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="mysql驱动包安装" tabindex="-1"><a class="header-anchor" href="#mysql驱动包安装" aria-hidden="true">#</a> MySQL驱动包安装</h2><p><code>mysql-connector-java-5.1.48.tar.gz</code>包的获取就不多说了, 同理hive</p><h3 id="解压" tabindex="-1"><a class="header-anchor" href="#解压" aria-hidden="true">#</a> 解压</h3><p>将该驱动包 <code>mysql-connector-java-5.1.48.tar.gz</code> 解压, 将其中的 <code>mysql-connector-java-5.1.48-bin.jar</code> 到 <code>$HIVE_HOME/lib</code> 中去</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">tar</span> <span class="token parameter variable">-zxf</span> mysql-connector-java-5.1.48.tar.gz
<span class="token function">mv</span> mysql-connector-java-5.1.48/mysql-connector-java-5.1.48-bin.jar <span class="token variable">$HIVE_HOME</span>/lib
<span class="token comment"># 删除解压出来的目录</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> mysql-connector-java-5.1.48
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="版本选择" tabindex="-1"><a class="header-anchor" href="#版本选择" aria-hidden="true">#</a> 版本选择</h3>`,20),b={href:"https://mvnrepository.com/artifact/mysql/mysql-connector-java",target:"_blank",rel:"noopener noreferrer"},m=t(`<p>建议使用适配版本, 最新版未必适合</p><p>我在 <code>hive-3.1.3</code> 使用 <code>mysql-connector-java-8.*.*</code> 版本时会出现版本不兼容的情况, 最后还是用回上面的 <code>mysql-connector-java-5.1.48</code> 版本</p><h3 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件" aria-hidden="true">#</a> 配置文件</h3><p>配置文件在 <code>$HIVE_HOME/conf</code> 下</p><p>进入该目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token variable">$HIVE_HOME</span>/conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),f={id:"hive-env-sh",tabindex:"-1"},y=a("a",{class:"header-anchor",href:"#hive-env-sh","aria-hidden":"true"},"#",-1),w={href:"http://hive-env.sh",target:"_blank",rel:"noopener noreferrer"},x=t(`<p>复制 <code>hive-env.sh.template</code> 为 <code>hive-env.sh</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> hive-env.sh.template hive-env.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>对 <code>hive-env.sh</code> 配置, 修改其 <code>HADOOP_HOME</code>, <code>HIVE_CONF_DIR</code>和 <code>HIVE_AUX_JARS_PATH</code> 三个配置项, 并将其注释去掉</p><p><code>HADOOP_HOME</code> 是Hadoop的Home目录</p><p><code>HIVE_CONF_DIR</code> 是Hive的配置目录, 默认为 <code>$HIVE_HOME/conf</code></p><p><code>HIVE_AUX_JARS_PATH</code> 是Hive存放jar包的路径 默认为 <code>$HIVE_HOME/lib</code></p><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/548ca484-3c14-4690-9c8c-c6e497130f26.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="hive-default-xml" tabindex="-1"><a class="header-anchor" href="#hive-default-xml" aria-hidden="true">#</a> hive-default.xml</h4><p>从模板中复制一份, 该文件为Hive默认加载文件可不用修改</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> hive-default.xml.template hive-default.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="hive-site-xml" tabindex="-1"><a class="header-anchor" href="#hive-site-xml" aria-hidden="true">#</a> hive-site.xml</h4><p>在 <code>$HIVE_HOME/conf</code> 中新建文件 <code>hive-site.xml</code>, 并向其中添加如下内容</p><blockquote><p><code>192.168.60.100</code> 是 mariadb 的 IP</p></blockquote><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://192.168.60.100:3306/hive?createDatabaseIfNotExist=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>useSSL=false<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionDriverName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hive<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionPassword<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/331d5d7c-1dbc-4333-ad6d-e9844b59de16.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="hive-运行" tabindex="-1"><a class="header-anchor" href="#hive-运行" aria-hidden="true">#</a> Hive 运行</h2><h3 id="初始化hive" tabindex="-1"><a class="header-anchor" href="#初始化hive" aria-hidden="true">#</a> 初始化hive</h3><p>这是将hive的数据库操作类型设置为mysql, <code>--verbose</code> 参数可以获得更加完整的日志信息, 方便追踪错误</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>schematool <span class="token parameter variable">-initSchema</span> <span class="token parameter variable">--verbose</span> <span class="token parameter variable">-dbType</span> mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/9e0077bd-c3e4-4b95-8bab-538e484fcfd6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="初始化问题" tabindex="-1"><a class="header-anchor" href="#初始化问题" aria-hidden="true">#</a> 初始化问题</h3><p>包括但不限于: <strong>JDBC版本不兼容</strong>, <strong>Hadoop与Hive版本不兼容</strong>, <strong>hive数据库已存在</strong> 等</p><h3 id="启动hadoop集群" tabindex="-1"><a class="header-anchor" href="#启动hadoop集群" aria-hidden="true">#</a> 启动Hadoop集群</h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>运行hive前一定要先启动Hadoop集群否则会出错</p></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>start-dfs.sh
start-yarn.sh
mr-jobhistory-daemon.sh start historyserver
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看hadoop服务进程" tabindex="-1"><a class="header-anchor" href="#查看hadoop服务进程" aria-hidden="true">#</a> 查看Hadoop服务进程</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>jps
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="主节点" tabindex="-1"><a class="header-anchor" href="#主节点" aria-hidden="true">#</a> 主节点</h4><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/f5af3363-f33e-4003-9068-2054cdf98d98.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="从节点" tabindex="-1"><a class="header-anchor" href="#从节点" aria-hidden="true">#</a> 从节点</h4><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/4470bc7f-ca1b-491f-9419-6b16ec480b7c.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="进入hive" tabindex="-1"><a class="header-anchor" href="#进入hive" aria-hidden="true">#</a> 进入hive</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hive
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/aa8ef352-c4a9-46ed-ad89-fd2b4a7af5d5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>查看下数据库, 或者使用其他的mysql命令来测试hive的可用性</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>show databases<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/bd8359f5-82ce-4d66-8d40-39d73ba95761.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="cli乱码处理" tabindex="-1"><a class="header-anchor" href="#cli乱码处理" aria-hidden="true">#</a> CLI乱码处理</h3><p>如果在hive的CLI中输入中文变成一串问号, 需要在 <code>$HIVE_HOME/conf/hive-env.sh</code> 文件的最后加上编码格式</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_OPTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$HADOOP_OPTS</span> -Dfile.encoding=UTF-8&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后再重启hive</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hive restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="汽车销售数据分析系统实战" tabindex="-1"><a class="header-anchor" href="#汽车销售数据分析系统实战" aria-hidden="true">#</a> 汽车销售数据分析系统实战</h2><p>相关文件</p>`,44),q=a("thead",null,[a("tr",null,[a("th",null,"文件"),a("th",null,"说明")])],-1),_={href:"https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/create_cars.sql",target:"_blank",rel:"noopener noreferrer"},j=a("td",null,"创建cars数据库和数据表",-1),H={href:"https://raw.githubusercontent.com/jellyqwq/PictureBed/main/2023/05/cars.txt",target:"_blank",rel:"noopener noreferrer"},B=a("td",null,"待写入数据文件",-1),P=t(`<h3 id="创建cars数据库表" tabindex="-1"><a class="header-anchor" href="#创建cars数据库表" aria-hidden="true">#</a> 创建cars数据库表</h3><p>在hive中执行下述命令以建立cars数据库, <code>source</code> 后跟主机路径, 而非 <code>hdfs</code> 内的路径</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>source create_cars<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/a4b17780-8710-4f48-b2d4-de31bbb4ffda.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="查看数据库表并退出" tabindex="-1"><a class="header-anchor" href="#查看数据库表并退出" aria-hidden="true">#</a> 查看数据库表并退出</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> car<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">exit</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/fea50ce9-096f-42d6-b3a0-55b7afe9f6b4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="hint-container tip"><p class="hint-container-title">提示</p><p><code>hadoop fs</code> 与 <code>hdfs dfs</code> 等价</p></div><h3 id="上传数据到hdfs中" tabindex="-1"><a class="header-anchor" href="#上传数据到hdfs中" aria-hidden="true">#</a> 上传数据到hdfs中</h3><p>上传前先检查下hdfs中是否存在 <code>/cars</code> 目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hdfs dfs <span class="token parameter variable">-ls</span> /
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>没有就先创建</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hdfs dfs <span class="token parameter variable">-mkdir</span> /cars
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果 <code>/cars</code> 目录内存在 <code>cars.txt</code> 文件, 再次上传前需要先删除该文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hdfs dfs <span class="token parameter variable">-rm</span> /cars/cars.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上传 <code>cars.txt</code> 到 <code>hdfs</code> 中的 <code>/cars</code> 目录内</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hdfs dfs <span class="token parameter variable">-put</span> cars.txt /cars
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>验证是否上传成功</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>hdfs dfs <span class="token parameter variable">-ls</span> /cars
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/9e2aef9f-dd74-408d-b924-c32a1e3b1106.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="将数据对数据库进行外联接" tabindex="-1"><a class="header-anchor" href="#将数据对数据库进行外联接" aria-hidden="true">#</a> 将数据对数据库进行外联接</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> car<span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> inpath <span class="token string">&#39;/cars/cars.txt&#39;</span> <span class="token keyword">into</span> <span class="token keyword">table</span> car_2019712<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/dc55fe0c-a212-40ec-baf8-29253bf39000.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="查看hive仓库的内容" tabindex="-1"><a class="header-anchor" href="#查看hive仓库的内容" aria-hidden="true">#</a> 查看hive仓库的内容</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/b1f2a6da-19e0-432b-afc1-3f8cfa34dec1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="统计乘用车辆和商用车辆的销售数量和销售占比" tabindex="-1"><a class="header-anchor" href="#统计乘用车辆和商用车辆的销售数量和销售占比" aria-hidden="true">#</a> 统计乘用车辆和商用车辆的销售数量和销售占比</h3><h4 id="_1统计乘用车辆和商用车辆的销售数量" tabindex="-1"><a class="header-anchor" href="#_1统计乘用车辆和商用车辆的销售数量" aria-hidden="true">#</a> ①统计乘用车辆和商用车辆的销售数量</h4><p>根据使用性质字段 <code>nature</code> 进行分组统计乘用车和商用车的总数量, 乘用车辆的使用性质为<strong>非营运</strong>, 商用车辆的使用性质为<strong>营运</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&#39;非营运&#39;</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>nature<span class="token operator">=</span><span class="token string">&#39;非营运&#39;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cnt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;营运&#39;</span><span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>nature<span class="token operator">!=</span><span class="token string">&#39;非营运&#39;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>cnt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> nature<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> nature <span class="token keyword">having</span> nature <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> nature <span class="token operator">!=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> a<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/2fe4cd30-043f-4846-ac9c-90fc0940e189.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2统计汽车销售总数量" tabindex="-1"><a class="header-anchor" href="#_2统计汽车销售总数量" aria-hidden="true">#</a> ②统计汽车销售总数量</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/aa9f2596-b2eb-47cb-bd21-1687cbefe74c.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3计算销售占比" tabindex="-1"><a class="header-anchor" href="#_3计算销售占比" aria-hidden="true">#</a> ③计算销售占比</h4><p>乘用车辆的销售数量占比 = 66478/70640 ≈ 94.1%</p><p>商用车辆的销售量占比 = 3884/70640 ≈ 5.5%</p><h3 id="统计山西省2013年每个月的汽车销售数量的比例" tabindex="-1"><a class="header-anchor" href="#统计山西省2013年每个月的汽车销售数量的比例" aria-hidden="true">#</a> 统计山西省2013年每个月的汽车销售数量的比例</h3><p>分别统计出山西省2013年每个月的汽车销售数量和山西省2013年年度汽车销售总数量, 再用2013年每个月的汽车销售数量除以年度销售总数量</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span>  <span class="token keyword">month</span><span class="token punctuation">,</span> c1<span class="token punctuation">.</span>ss<span class="token operator">/</span>c2<span class="token punctuation">.</span>sumshu <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">month</span><span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>quantity<span class="token punctuation">)</span> <span class="token keyword">as</span> ss <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712
<span class="token keyword">where</span> province<span class="token operator">=</span><span class="token string">&#39;山西省&#39;</span> <span class="token operator">and</span> <span class="token keyword">year</span><span class="token operator">=</span><span class="token string">&#39;2013&#39;</span> <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">month</span><span class="token punctuation">)</span> c1<span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>quantity<span class="token punctuation">)</span> <span class="token keyword">as</span> sumshu <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712
<span class="token keyword">where</span> province<span class="token operator">=</span><span class="token string">&#39;山西省&#39;</span> <span class="token operator">and</span> <span class="token keyword">year</span><span class="token operator">=</span><span class="token string">&#39;2013&#39;</span><span class="token punctuation">)</span> c2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/778fbd4e-3679-49e0-ae04-e9d7cc4a0cfc.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>根据计算结果可知, 汽车销售销售的高峰期位于10月到1月, 这四个月的汽车销售数量都占到全年销售的10%, 其中一月份最为显著, 达到了14.8%</p><div class="hint-container tip"><p class="hint-container-title">注意</p><p>若代码报错如下报错，则分别运行一下两行命令以解除禁用</p><p><code>FAILED: SemanticException Cartesian products are disabled for safety reasons. If you know what you are doing, please sethive.strict.checks.cartesian.product to false and that hive.mapred.mode is not set to &#39;strict&#39; to proceed. Note that if you may get errors or incorrect results if you make a mistake while using some of the unsafe features.</code></p></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">set</span> hive<span class="token punctuation">.</span>strict<span class="token punctuation">.</span>checks<span class="token punctuation">.</span>cartesian<span class="token punctuation">.</span>product<span class="token operator">=</span>flase<span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span><span class="token keyword">mode</span><span class="token operator">=</span>nonstrict<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="统计买车的男女比例及男女对车的品牌的选择" tabindex="-1"><a class="header-anchor" href="#统计买车的男女比例及男女对车的品牌的选择" aria-hidden="true">#</a> 统计买车的男女比例及男女对车的品牌的选择</h3><h4 id="_1统计买车的男女比例" tabindex="-1"><a class="header-anchor" href="#_1统计买车的男女比例" aria-hidden="true">#</a> ①统计买车的男女比例</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&#39;男性&#39;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>nan<span class="token operator">*</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>nan<span class="token operator">+</span>a<span class="token punctuation">.</span>nv<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;女性 &#39;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>nv<span class="token operator">*</span><span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>nan<span class="token operator">+</span>a<span class="token punctuation">.</span>nv<span class="token punctuation">)</span> <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token string">&#39;男性&#39;</span><span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>gender<span class="token operator">=</span><span class="token string">&#39;男性&#39;</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> nan<span class="token punctuation">,</span>
<span class="token string">&#39;女性&#39;</span><span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>gender<span class="token operator">=</span><span class="token string">&#39;女性&#39;</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> nv <span class="token keyword">from</span><span class="token punctuation">(</span> 
<span class="token keyword">select</span> gender<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt 
<span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 <span class="token keyword">group</span> <span class="token keyword">by</span> gender <span class="token keyword">having</span> gender <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> gender<span class="token operator">!=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> b<span class="token punctuation">)</span>a<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/a69f67a3-7ee3-4e57-97d7-2de7bff5112b.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>根据计算结果, 男性占比70.1%, 女性占比29.9%</p><h4 id="_2统计男女对车的品牌选择比例" tabindex="-1"><a class="header-anchor" href="#_2统计男女对车的品牌选择比例" aria-hidden="true">#</a> ②统计男女对车的品牌选择比例</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> gender<span class="token punctuation">,</span>brand<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">where</span> gender <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> gender<span class="token operator">!=</span><span class="token string">&#39;&#39;</span> <span class="token operator">and</span> age <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">,</span>brand <span class="token keyword">having</span> brand <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> brand<span class="token operator">!=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/8c76963b-3fc0-482a-a96e-413892bf0a6c.png" alt="图示为部分结果" tabindex="0" loading="lazy"><figcaption>图示为部分结果</figcaption></figure><h3 id="统计车的所有权、车辆型号和车辆类型" tabindex="-1"><a class="header-anchor" href="#统计车的所有权、车辆型号和车辆类型" aria-hidden="true">#</a> 统计车的所有权、车辆型号和车辆类型</h3><h4 id="_1统计车的所有权" tabindex="-1"><a class="header-anchor" href="#_1统计车的所有权" aria-hidden="true">#</a> ①统计车的所有权</h4><p>根据车辆的所有权字段 <code>owership</code> 进行分组统计, 得出属于个人的车辆总数, 属于单位的车辆总数或者其他</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> ownership<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> ownership <span class="token keyword">order</span> <span class="token keyword">by</span> cnt <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/2df5d703-a783-4454-a44c-324796662f74.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2统计车辆型号" tabindex="-1"><a class="header-anchor" href="#_2统计车辆型号" aria-hidden="true">#</a> ②统计车辆型号</h4><p>根据车辆型号字段 <code>model</code> 进行分组统计, 得出各种不同车辆型号的总数量</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> model<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> model <span class="token keyword">order</span> <span class="token keyword">by</span> cnt <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/268ec82e-cc40-4331-84e1-12515629d036.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_3统计车辆类型" tabindex="-1"><a class="header-anchor" href="#_3统计车辆类型" aria-hidden="true">#</a> ③统计车辆类型</h4><p>根据车辆类型字段vehicletype进行分组统计</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> vehicletype<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> vehicletype <span class="token keyword">order</span> <span class="token keyword">by</span> cnt <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/3769ef53-c1ca-42f1-80c4-a7c3abee8d5a.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="统计不同类型车在一个月的总销售量" tabindex="-1"><a class="header-anchor" href="#统计不同类型车在一个月的总销售量" aria-hidden="true">#</a> 统计不同类型车在一个月的总销售量</h3><p>统计不同类型车在一个月的总销售量, 即统计某一年某一个月某一类型的车</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">month</span><span class="token punctuation">,</span> vehicletype<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> vehicletype<span class="token punctuation">,</span> <span class="token keyword">month</span> <span class="token keyword">having</span> <span class="token keyword">month</span> <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> 
<span class="token operator">and</span> vehicletype <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> vehicletype <span class="token operator">!=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/33e5089c-eae3-417c-bd2f-3dba276db4bd.png" alt="图示为部分结果" tabindex="0" loading="lazy"><figcaption>图示为部分结果</figcaption></figure><h3 id="通过不同类型-品牌-车销量情况-来统计发动机型号和燃料种类" tabindex="-1"><a class="header-anchor" href="#通过不同类型-品牌-车销量情况-来统计发动机型号和燃料种类" aria-hidden="true">#</a> 通过不同类型（品牌）车销量情况，来统计发动机型号和燃料种类</h3><p>根据车辆的品牌字段 <code>brand</code>, 发动机型号字段 <code>enginemodel</code> 和燃油种类字段 <code>fuel</code> 进行分组统计</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> brand<span class="token punctuation">,</span> enginemodel<span class="token punctuation">,</span> fuel<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> brand<span class="token punctuation">,</span> enginemodel<span class="token punctuation">,</span> fuel<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/36c45d3d-ae15-4f50-8e93-6eda4aad3e9d.png" alt="图示为部分结果" tabindex="0" loading="lazy"><figcaption>图示为部分结果</figcaption></figure><h3 id="统计五菱某一年每月的销售量" tabindex="-1"><a class="header-anchor" href="#统计五菱某一年每月的销售量" aria-hidden="true">#</a> 统计五菱某一年每月的销售量</h3><p>根据汽车的品牌 <code>brand</code> 和月 <code>month</code> 两个字段进行分组统计, 并从结果中将品牌名为 <code>五菱</code> 的数据过滤出来</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> brand<span class="token punctuation">,</span> <span class="token keyword">month</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> car<span class="token punctuation">.</span>car_2019712 
<span class="token keyword">group</span> <span class="token keyword">by</span> brand<span class="token punctuation">,</span> <span class="token keyword">month</span> <span class="token keyword">having</span> brand<span class="token operator">=</span><span class="token string">&#39;五菱&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/jellyqwq/PictureBed@main/2023/05/65bb952b-9b3d-42f8-98eb-ef99ed94c887.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,77);function A(E,D){const s=o("ExternalLinkIcon");return c(),i("div",null,[r,l(" |-v|/d/Desktop/BD/mariadb/data:/var/lib/mysql|挂载数据目录| "),a("p",null,[n("更多环境变量及参数移步至"),a("a",u,[n("官方文档"),e(s)])]),k,a("p",null,[n("从"),a("a",h,[n("官网"),e(s)]),n("下载, 可以查看不同Hadoop所支持的Hive")]),a("p",null,[n("由于我hadoop是3.2.4的, 所以我用"),a("a",v,[n("hive-3.1.3"),e(s)])]),g,a("p",null,[n("可以在"),a("a",b,[n("mvnrepository"),e(s)]),n("找到所有jdbc的下载")]),m,a("h4",f,[y,n(),a("a",w,[n("hive-env.sh"),e(s)])]),x,a("table",null,[q,a("tbody",null,[a("tr",null,[a("td",null,[a("a",_,[n("create_cars.sql"),e(s)])]),j]),a("tr",null,[a("td",null,[a("a",H,[n("cars.txt"),e(s)])]),B])])]),P])}const z=p(d,[["render",A],["__file","deploy-hive.html.vue"]]);export{z as default};
