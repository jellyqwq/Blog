import{_ as e}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as o,o as c,c as u,f as l,b as n,d as a,e as t,a as p}from"./app-XoEOURcT.js";const r={},i=n("p",null,"本文讲述了torch.nn.Linear对象是怎么完成计算过程",-1),k=p('<h2 id="简述" tabindex="-1"><a class="header-anchor" href="#简述" aria-hidden="true">#</a> 简述</h2><p>torch.nn.Linear是一个用于线性变换(linear transformation)的对象, 它有三个参数</p><p>in_features: 输入特征, 输入张量的最后一个维度大小, <code>torch.Size([N,*,in_features])</code></p><p>out_features: 输出特征, 输出张量的最后一个维度大小, <code>torch.Size([N,*,out_features])</code></p><p>bias: 偏差值, 对线性变换进行拟合</p><h2 id="公式说明" tabindex="-1"><a class="header-anchor" href="#公式说明" aria-hidden="true">#</a> 公式说明</h2>',6),d={href:"https://pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear",target:"_blank",rel:"noopener noreferrer"},m=p(`<p>y: 每个输出层<br> x: 每个输入层<br> A: weight, 在Linear对象初始化时随机生成<br> b: bias, 也在Linear对象初始化时随机生成</p><p>结合实例来看下</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> torch
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">input</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> linear <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> linear<span class="token punctuation">.</span>weight
Parameter containing<span class="token punctuation">:</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.0234</span><span class="token punctuation">,</span>  <span class="token number">0.4268</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2368</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.1149</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1424</span><span class="token punctuation">,</span>  <span class="token number">0.3393</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> linear<span class="token punctuation">.</span>bias
Parameter containing<span class="token punctuation">:</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.4623</span><span class="token punctuation">,</span> <span class="token number">0.1044</span><span class="token punctuation">]</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所以实际上是$y = input @ linear.weight^T + linear.bias$</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">input</span> @ linear<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>T <span class="token operator">+</span> linear<span class="token punctuation">.</span>bias
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.6288</span><span class="token punctuation">,</span> <span class="token number">0.9526</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1.2689</span><span class="token punctuation">,</span> <span class="token number">1.8884</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1.9089</span><span class="token punctuation">,</span> <span class="token number">2.8241</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grad_fn<span class="token operator">=</span><span class="token operator">&lt;</span>AddBackward0<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> m<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.6288</span><span class="token punctuation">,</span> <span class="token number">0.9526</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1.2689</span><span class="token punctuation">,</span> <span class="token number">1.8884</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1.9089</span><span class="token punctuation">,</span> <span class="token number">2.8241</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grad_fn<span class="token operator">=</span><span class="token operator">&lt;</span>AddmmBackward0<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考文献" tabindex="-1"><a class="header-anchor" href="#参考文献" aria-hidden="true">#</a> 参考文献</h2>`,6),b={href:"https://pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear",target:"_blank",rel:"noopener noreferrer"},h={href:"https://ckmarkoh.github.io/blog/2016/12/19/torch-nn-tutorial-1-nn-module/",target:"_blank",rel:"noopener noreferrer"},g={href:"https://ashwinhprasad.medium.com/pytorch-for-deep-learning-nn-linear-and-nn-relu-explained-77f3e1007dbb",target:"_blank",rel:"noopener noreferrer"};function v(_,f){const s=o("ExternalLinkIcon");return c(),u("div",null,[i,l(" more "),k,n("p",null,[a("在"),n("a",d,[a("Pytorch文档"),t(s)]),a("中给到的公式是 $y=xA^T+b$")]),m,n("ol",null,[n("li",null,[n("a",b,[a("https://pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear"),t(s)])]),n("li",null,[n("a",h,[a("https://ckmarkoh.github.io/blog/2016/12/19/torch-nn-tutorial-1-nn-module/"),t(s)])]),n("li",null,[n("a",g,[a("https://ashwinhprasad.medium.com/pytorch-for-deep-learning-nn-linear-and-nn-relu-explained-77f3e1007dbb"),t(s)])])])])}const L=e(r,[["render",v],["__file","torch.nn.Linear.html.vue"]]);export{L as default};
